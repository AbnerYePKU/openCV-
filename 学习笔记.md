## openCV学习笔记

### 基本功能
```
1. cv2.imread(filename,flags)
2. cv2.imshow(winname,mat)
3. cv2.imwrite(filename,img,params)
4. cv2.waitKey(delay)
5. cv2.namedWindow(winname,flags)
```
1. 该函数读取一个图片文件，返回一个numpy数组对象，参数为0为灰色
2. 该函数显示一个img图像，winname为进程的名称(使用时需要使用`cv.waitkey(0))`进行暂停
3. 将图像文件输出，文件名为filename(加后缀名)
4. 在delay(ms)内的时间内等待用户的键盘行为。delay==0意味着将无限等待用户的指令。函数的返回值是当前的键盘按键。
5. 函数将打开名为winname的窗口/进程
### 作图
- `img`:图像文件
- `pt`：点(2个整数组成的tuple，坐标从左上角开始，分别代表横坐标和纵坐标)
- `color`：颜色，在openCV中，用BGR进行
- `thickness`：图像的厚度，设置为负数导致图像是实心

```
1. cv2.line(img,pt1,pt2,color,thickness)
2. cv2.rectangle(img,pt1,pt2,color,thickness)
3. cv2.circle(img,center,radius,color,thickness)
```

还有`polylines`函数和`putText`函数

### 鼠标动作
```python
cv2.setMouseCallback(WindowName,onMouse)
```
在WindowName这个窗口当中加入onMouse函数，每发生一次事件将执行一次onMouse函数

onMouse的函数原型是：
```python
f(event,x,y,flags,param):
```
event表示鼠标事件，x,y分别表示事件发生的横、纵坐标

```
cv2_EVENT_MOUSEMOVE 0  滑动 
cv2_EVENT_LBUTTONDOWN 1 左键点击 
cv2_EVENT_RBUTTONDOWN 2 右键点击 
cv2_EVENT_MBUTTONDOWN 3 中间点击 
cv2_EVENT_LBUTTONUP 4 左键释放 
cv2_EVENT_RBUTTONUP 5 右键释放 
cv2_EVENT_MBUTTONUP 6 中间释放 
cv2_EVENT_LBUTTONDBLCLK 7 左键双击 
cv2_EVENT_RBUTTONDBLCLK 8 右键双击 
cv2_EVENT_MBUTTONDBLCLK 9 中间释放
cv2_EVENT_FLAG_LBUTTON 1 左键拖拽  
cv2_EVENT_FLAG_RBUTTON 2 右键拖拽  
cv2_EVENT_FLAG_MBUTTON 4 中间拖拽  
cv2_EVENT_FLAG_CTRLKEY 8 (8~15)按Ctrl不放事件  
cv2_EVENT_FLAG_SHIFTKEY 16 (16~31)按Shift不放事件  
cv2_EVENT_FLAG_ALTKEY 32 (32~39)按Alt不放事件
```

例程：
```python
import cv2
import numpy as np

global radius
radius=80

# 鼠标点击时的回调函数
def draw_circle(event,x,y,flags,param):
    global radius
    if event == cv2.EVENT_MOUSEMOVE or cv2.EVENT_LBUTTONDOWN:
        if event==cv2.EVENT_LBUTTONDOWN:radius=80
        cv2.circle(img,(x,y),radius,(0,0,200),3)
        radius=int(radius*0.99)

# 建立例程运行窗口，以及其中回调函数的设置
img = np.zeros((512,512,3), np.uint8)
cv2.namedWindow('image')
cv2.setMouseCallback('image',draw_circle)

# 设定循环的时间间隔
while(1):
    cv2.imshow('image',img)
    if cv2.waitKey(20) & 0xFF == 27:
        break
cv2.destroyAllWindows()
```
循环当中的waitKey(20)除了等待键盘指令以外，还起到了时间延迟的作用。如果键盘没有发出行为，那么imshow函数(即刷新图像)将以20ms的间隔执行。
